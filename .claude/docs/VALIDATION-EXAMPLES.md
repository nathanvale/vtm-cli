# Validation Examples

This document shows real-world examples of how the validation system works across all plan commands.

---

## Example 1: Creating an ADR with Related ADRs

### Scenario: Valid Related ADRs

```bash
/plan:create-adr "API authentication strategy" --related-adrs=ADR-001,ADR-003
```

**Validation Output:**

```
🔍 Validating related ADRs: ADR-001,ADR-003
✅ ADR-001 validated
✅ ADR-003 validated

📝 Creating ADR-004
🔍 Researching decision: API authentication strategy
🤖 Launching ADR creation agent...
```

### Scenario: Missing Related ADR

```bash
/plan:create-adr "API authentication strategy" --related-adrs=ADR-001,ADR-999
```

**Validation Output:**

```
🔍 Validating related ADRs: ADR-001,ADR-999
✅ ADR-001 validated
⚠️  Warning: Related ADR not found: ADR-999
   This ADR will be referenced but doesn't exist yet

⚠️  Found 1 warning(s) in related ADRs
   You can still proceed, but review the warnings above

📝 Creating ADR-004
...continues normally...
```

### Scenario: Incomplete Related ADR

```bash
/plan:create-adr "API authentication strategy" --related-adrs=ADR-002
```

Where `ADR-002.md` is missing the Decision section:

**Validation Output:**

```
🔍 Validating related ADRs: ADR-002
⚠️  Warning: ADR-002 missing sections: Decision
✅ ADR-002 validated

⚠️  Found 1 warning(s) in related ADRs
   You can still proceed, but review the warnings above

📝 Creating ADR-004
...continues normally...
```

---

## Example 2: Generating ADRs from PRD

### Scenario: Valid PRD

```bash
/plan:generate-adrs docs/prd/auth-system.md
```

**Validation Output:**

```
🔍 Validating PRD file...
✅ PRD validation passed
   File: docs/prd/auth-system.md
   Lines: 45

📝 Analyzing PRD: docs/prd/auth-system.md
🔍 Launching ADR generation agent...
```

### Scenario: PRD Too Short

```bash
/plan:generate-adrs docs/prd/incomplete.md
```

Where `incomplete.md` has only 5 lines:

**Validation Output:**

```
🔍 Validating PRD file...
❌ Error: PRD file appears too short (5 lines, recommended: 10+)
   PRD files should contain substantial planning content

[Command exits with error code 1]
```

### Scenario: PRD Missing Decision Content

```bash
/plan:generate-adrs docs/prd/requirements-only.md
```

Where `requirements-only.md` has no decision keywords:

**Validation Output:**

```
🔍 Validating PRD file...
⚠️  Warning: PRD may not contain explicit architectural decisions
   ADR generation works best when PRD includes decision points
   Example: 'Decision: Use OAuth2 for authentication'

⚠️  Warning: PRD missing recommended sections: Technical, Requirements
   ADRs may have limited context without these sections

✅ PRD validation passed
   File: docs/prd/requirements-only.md
   Lines: 25

📝 Analyzing PRD: docs/prd/requirements-only.md
...continues but may generate poor ADRs...
```

### Scenario: Invalid PRD File

```bash
/plan:generate-adrs docs/prd/not-a-prd.md
```

Where the file is just plain text:

**Validation Output:**

```
🔍 Validating PRD file...
⚠️  Warning: File may not be a valid PRD (missing 'spec_type: prd' header)
   This might be a regular markdown file, not a PRD generated by /plan:create-prd

⚠️  Warning: PRD may not contain explicit architectural decisions
   ADR generation works best when PRD includes decision points
   Example: 'Decision: Use OAuth2 for authentication'

✅ PRD validation passed
   File: docs/prd/not-a-prd.md
   Lines: 15

📝 Analyzing PRD: docs/prd/not-a-prd.md
...continues but will likely fail in extraction...
```

---

## Example 3: Creating Spec from ADR

### Scenario: Valid ADR

```bash
/plan:create-spec docs/adr/ADR-001-auth.md
```

**Validation Output:**

```
🔍 Validating ADR file...
✅ ADR validation passed
   File: docs/adr/ADR-001-auth.md
   Alternatives: 4

📝 Creating spec from: docs/adr/ADR-001-auth.md
🔍 Launching implementation research agent...
```

### Scenario: ADR Missing Required Sections

```bash
/plan:create-spec docs/adr/ADR-002-incomplete.md
```

Where `ADR-002-incomplete.md` is missing Consequences section:

**Validation Output:**

```
🔍 Validating ADR file...
❌ Error: ADR missing required sections: Consequences
   ADRs must have Status, Context, Decision, and Consequences sections

💡 Use /plan:create-adr to create a properly structured ADR

[Command exits with error code 1]
```

### Scenario: ADR with Few Alternatives

```bash
/plan:create-spec docs/adr/ADR-003-simple.md
```

Where `ADR-003-simple.md` has only 1 alternative:

**Validation Output:**

```
🔍 Validating ADR file...
⚠️  Warning: ADR has only 1 alternatives (recommended: 3+)
   Spec will have limited context about alternatives considered

✅ ADR validation passed
   File: docs/adr/ADR-003-simple.md
   Alternatives: 1

📝 Creating spec from: docs/adr/ADR-003-simple.md
...continues but spec may lack depth...
```

### Scenario: File is Not an ADR

```bash
/plan:create-spec docs/notes/random-notes.md
```

**Validation Output:**

```
🔍 Validating ADR file...
❌ Error: File does not appear to be an ADR
   Missing ADR header (e.g., '# ADR-001: Title')

💡 Example: /plan:create-spec docs/adr/ADR-001-auth.md

[Command exits with error code 1]
```

---

## Example 4: Converting ADR+Spec to VTM Tasks

### Scenario: Valid Pairing

```bash
/plan:to-vtm docs/adr/ADR-001-auth.md docs/specs/spec-auth.md
```

**Validation Output:**

```
🔍 Validating input files...
✅ File validation passed
   ADR: docs/adr/ADR-001-auth.md
   Spec: docs/specs/spec-auth.md
   Pairing: Valid (spec references ADR-001)

🤖 Extracting tasks from ADR+Spec pair...
```

### Scenario: Mismatched ADR+Spec Pair

```bash
/plan:to-vtm docs/adr/ADR-001-auth.md docs/specs/spec-profile.md
```

Where `spec-profile.md` doesn't reference `ADR-001`:

**Validation Output:**

```
🔍 Validating input files...
❌ Error: Spec does not reference the ADR
   docs/specs/spec-profile.md does not mention ADR-001-auth.md

   This prevents accidental pairing of unrelated ADR+Spec files.
   The spec should reference the ADR it implements.

💡 Fix: Add a reference to the ADR in the spec file:
   Example: "Implements ADR-001-auth.md"

[Command exits with error code 1]
```

### Scenario: Wrong File Order

```bash
/plan:to-vtm docs/specs/spec-auth.md docs/adr/ADR-001-auth.md
```

**Validation Output:**

```
🔍 Validating input files...
❌ Error: First argument must be an ADR file
   Path should contain /adr/ directory

💡 Example: /plan:to-vtm docs/adr/ADR-001-auth.md docs/specs/spec-auth.md

[Command exits with error code 1]
```

### Scenario: Spec Missing Code Examples

```bash
/plan:to-vtm docs/adr/ADR-001-auth.md docs/specs/spec-minimal.md
```

Where `spec-minimal.md` has no code blocks:

**Validation Output:**

```
🔍 Validating input files...
⚠️  Warning: Spec has no code examples
   Task context will be limited without code examples

⚠️  Warning: Spec missing Acceptance Criteria section
   Tasks may not have clear completion criteria

✅ File validation passed
   ADR: docs/adr/ADR-001-auth.md
   Spec: docs/specs/spec-minimal.md
   Pairing: Valid (spec references ADR-001)

🤖 Extracting tasks from ADR+Spec pair...
...continues but tasks may lack detail...
```

### Scenario: Invalid ADR Structure

```bash
/plan:to-vtm docs/adr/ADR-002-incomplete.md docs/specs/spec-auth.md
```

Where `ADR-002-incomplete.md` is missing Decision section:

**Validation Output:**

```
🔍 Validating input files...
❌ Error: ADR missing required sections: Decision
   Task extraction requires complete ADR structure

💡 Use /plan:create-adr to create a properly structured ADR

[Command exits with error code 1]
```

---

## Validation Error Patterns

### Pattern 1: File Not Found

**Applies to:** All commands
**Severity:** Error (blocks execution)

```
❌ Error: File not found
  ADR: docs/adr/missing.md
  Spec: docs/specs/spec-auth.md

💡 Example: /plan:to-vtm docs/adr/ADR-001-auth.md docs/specs/spec-auth.md
```

### Pattern 2: Invalid Structure

**Applies to:** create-spec, to-vtm
**Severity:** Error (blocks execution)

```
❌ Error: File does not appear to be an ADR
   Missing ADR header (e.g., '# ADR-001: Title')

💡 Use /plan:create-adr to create a properly structured ADR
```

### Pattern 3: Missing Required Sections

**Applies to:** create-spec, to-vtm
**Severity:** Error (blocks execution)

```
❌ Error: ADR missing required sections: Status, Decision
   ADRs must have Status, Context, Decision, and Consequences sections

💡 Use /plan:create-adr to create a properly structured ADR
```

### Pattern 4: Quality Warnings

**Applies to:** All commands
**Severity:** Warning (allows execution)

```
⚠️  Warning: ADR has only 1 alternatives (recommended: 3+)
   Spec will have limited context about alternatives considered

⚠️  Warning: Spec has no code examples
   Task context will be limited without code examples
```

### Pattern 5: Pairing Errors

**Applies to:** to-vtm
**Severity:** Error (blocks execution)

```
❌ Error: Spec does not reference the ADR
   docs/specs/spec-auth.md does not mention ADR-001-profile.md

   This prevents accidental pairing of unrelated ADR+Spec files.
   The spec should reference the ADR it implements.

💡 Fix: Add a reference to the ADR in the spec file:
   Example: "Implements ADR-001-profile.md"
```

---

## Best Practices

### 1. Always Validate Before Running Long Processes

Run validation checks early to catch errors before investing time:

```bash
# Instead of:
/plan:generate-adrs docs/prd/feature.md  # Might fail after 5 minutes

# Do:
# Check PRD structure first, then run
```

### 2. Fix Errors, Review Warnings

- **Errors (❌):** Must be fixed before proceeding
- **Warnings (⚠️):** Review and decide if acceptable

### 3. Use Provided Examples

Every error message includes an example of correct usage:

```
💡 Example: /plan:to-vtm docs/adr/ADR-001-auth.md docs/specs/spec-auth.md
```

Copy and adapt these examples for your use case.

### 4. Keep Files in Standard Locations

Validation checks file paths for standard directories:

- ADRs: `docs/adr/` or `*/adr/`
- Specs: `docs/specs/` or `*/spec*/`
- PRDs: `docs/prd/` or `*/prd/`

Following these conventions helps validation work correctly.

### 5. Reference ADRs in Specs

Always include ADR reference in spec frontmatter:

```markdown
---
title: "Technical Specification: Authentication"
source_adr: ADR-001-auth.md
---

# Technical Specification: Authentication

Implements ADR-001-auth.md
```

This ensures `/plan:to-vtm` can validate pairing.

---

## Troubleshooting

### Issue: "ADR missing required sections"

**Solution:** Use `/plan:create-adr` to generate properly structured ADRs, or manually add missing sections:

```markdown
## Status

Accepted

## Context

[Why this decision is needed]

## Decision

[What we decided]

## Consequences

[Impact of this decision]
```

### Issue: "Spec does not reference the ADR"

**Solution:** Add ADR reference to spec file:

```markdown
**Source ADR:** ADR-001-auth.md

or

Implements ADR-001-auth.md
```

### Issue: "PRD appears too short"

**Solution:** PRDs need substantial content (10+ lines minimum). Add:

- Problem statement
- User requirements
- Technical decisions
- Scope definition

### Issue: "File may not be a valid PRD"

**Solution:** Add PRD frontmatter:

```markdown
---
spec_type: prd
title: "Feature Name"
---

# PRD: Feature Name
```

---

**Last Updated:** 2025-10-30
**Related:** VALIDATION-INTEGRATION-SUMMARY.md
